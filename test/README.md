# Тесты для приложения PlayBall

Этот каталог содержит тесты для приложения PlayBall (волейбол).

## Структура тестов

```
test/
├── unit/                 # Unit тесты
│   ├── user_model_test.dart    # Тесты модели пользователя
│   └── room_model_test.dart    # Тесты модели комнаты
├── widget/               # Widget тесты
│   ├── profile_screen_test.dart         # Тесты экрана профиля
│   └── team_members_screen_test.dart    # Тесты экрана участников команды
├── integration/          # Интеграционные тесты
│   └── app_flow_test.dart      # Тесты пользовательских сценариев
└── README.md            # Эта документация
```

## Типы тестов

### 1. Unit тесты (`test/unit/`)
Тестируют отдельные классы и функции в изоляции:

- **UserModel тесты**: Проверяют создание, копирование, сериализацию пользователей
- **RoomModel тесты**: Проверяют логику комнат, статусы, режимы игры
- **Покрытие**: Модели данных, утилиты, валидаторы

### 2. Widget тесты (`test/widget/`)
Тестируют отдельные экраны и виджеты:

- **ProfileScreen тесты**: Отображение профиля, статистики, вкладок
- **TeamMembersScreen тесты**: Список участников, управление друзьями
- **Покрытие**: UI компоненты, взаимодействия пользователя

### 3. Интеграционные тесты (`test/integration/`)
Тестируют полные пользовательские сценарии:

- **Навигация** между экранами
- **Создание игр** и присоединение к ним
- **Управление профилем** и командами
- **Responsive дизайн** на разных устройствах

## Запуск тестов

### Все тесты
```bash
flutter test
```

### Unit тесты
```bash
flutter test test/unit/
```

### Widget тесты
```bash
flutter test test/widget/
```

### Интеграционные тесты
```bash
flutter test test/integration/
```

### Конкретный файл
```bash
flutter test test/unit/user_model_test.dart
```

### С покрытием кода
```bash
flutter test --coverage
```

## Что тестируется

### Модели данных
- ✅ UserModel: создание, копирование, сериализация
- ✅ RoomModel: статусы, режимы игры, валидация
- ✅ PlayerRef и GameRef: вспомогательные классы
- ✅ Вычисляемые свойства (winRate, experienceLevel)

### UI Компоненты
- ✅ ProfileScreen: отображение профиля, статистики
- ✅ TeamMembersScreen: список участников команды
- ✅ Навигация между вкладками
- ✅ Responsive дизайн
- ✅ Обработка состояний загрузки

### Пользовательские сценарии
- ✅ Запуск приложения
- ✅ Навигация между экранами
- ✅ Создание и поиск игр
- ✅ Управление профилем
- ✅ Scroll и pull-to-refresh

### Логика приложения
- ✅ Статусы игр и комнат
- ✅ Режимы игры (обычный/командный)
- ✅ Роли пользователей
- ✅ Валидация данных

## Зависимости для тестирования

Добавлены в `pubspec.yaml`:
```yaml
dev_dependencies:
  flutter_test:
    sdk: flutter
  mockito: ^5.4.4
  build_runner: ^2.4.9
  fake_cloud_firestore: ^3.0.3
  firebase_auth_mocks: ^0.14.1
  integration_test:
    sdk: flutter
```

## Рекомендации

### Для добавления новых тестов:

1. **Unit тесты**: Добавляйте для каждой новой модели и утилиты
2. **Widget тесты**: Создавайте для каждого нового экрана
3. **Integration тесты**: Добавляйте для новых пользовательских сценариев

### Лучшие практики:

- Используйте описательные имена тестов на русском языке
- Группируйте связанные тесты в `group()`
- Используйте `setUp()` для подготовки тестовых данных
- Тестируйте как успешные, так и ошибочные сценарии
- Проверяйте edge cases (пустые данные, null значения)

### Покрытие кода:

Стремитесь к покрытию:
- **Unit тесты**: 90%+ для моделей и утилит
- **Widget тесты**: 80%+ для экранов
- **Integration тесты**: основные пользовательские сценарии

## Troubleshooting

### Типичные проблемы:

1. **Firebase не инициализирован**: Используйте моки для тестов
2. **Провайдеры не найдены**: Оборачивайте в `ProviderScope`
3. **Асинхронные операции**: Используйте `await tester.pumpAndSettle()`
4. **Навигация**: Оборачивайте в `MaterialApp` для тестов

### Полезные команды:

```bash
# Генерация моков
flutter packages pub run build_runner build

# Запуск тестов с подробным выводом
flutter test --verbose

# Запуск конкретного теста
flutter test --name "должен создавать пользователя"
```

## Дальнейшее развитие

Планируются дополнительные тесты для:
- [ ] FirestoreService (с моками)
- [ ] AuthService
- [ ] StorageService
- [ ] Провайдеры состояния
- [ ] Роутинг и навигация
- [ ] Валидаторы форм
- [ ] Утилиты 